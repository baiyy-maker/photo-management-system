# 宝格立印 - 照片管理系统使用说明

## 一、管理员端使用方法（支持自适应电脑、手机、iPad等多种设备）

### 1. 登录系统
- 系统默认有一个主管理员账户，账户名为 admin，密码为 
- 主管理员可以创建子管理员账户
- 登录成功后进入管理员控制面板

### 2. 用户管理
- **创建用户**：
  - 主管理员：可以创建子管理员、商家、客户账户
  - 子管理员：只能创建商家、客户账户
  - 创建成功后系统会显示成功提示
- **用户列表**：
  - 查看所有用户信息，包括用户名、角色、状态、创建时间、最后登录时间
  - 支持按用户名模糊搜索功能
  - 智能角色排序：主管理员→子管理员→商家→客户
  - 支持分页浏览，默认每页显示20条记录
- **用户状态管理**：
  - 启用/禁用用户：可以禁用任何用户账户
  - 禁用时需填写禁用理由，系统会记录操作日志
  - 被禁用的用户无法登录系统
- **密码管理**：
  - 重置用户密码：管理员可以为任何用户重置密码
  - 子管理员只能重置商家和客户的密码，不能重置主管理员和其他子管理员的密码
  - 重置密码会记录在操作日志中

### 3. 操作日志管理
- **查看权限**：
  - 主管理员：可以查看所有用户（包括自己、子管理员、商家、客户）的操作记录
  - 子管理员：可以查看自己、所有商家、所有客户的操作记录
- **日志内容**：
  - 显示用户ID、用户名、操作类型、操作详情、操作时间
  - 所有操作类型和详情都显示为中文，便于理解
  - 详情格式统一，包含角色、状态等完整信息
- **日志筛选**：
  - 支持按用户筛选查看特定用户的操作记录
  - 可搜索用户下拉框，支持模糊搜索用户名
  - 实时筛选，输入时即时显示匹配结果
- **分页功能**：
  - 支持分页浏览，默认每页显示20条记录
  - 可选择每页显示10、20、50、100条记录
  - 支持直接跳转到指定页码
- **记录数量**：每个用户显示最近1000条操作记录

### 4. 权限说明
| 操作 | 主管理员 | 子管理员 |
|------|----------|----------|
| 创建子管理员 | ✓ | ✗ |
| 创建商家/客户 | ✓ | ✓ |
| 查看所有用户 | ✓ | ✓（除主管理员和其他子管理员） |
| 禁用/启用用户 | ✓ | ✓（除主管理员和其他子管理员） |
| 查看操作日志 | ✓（所有用户） | ✓（自己+商家+客户） |

## 二、客户端使用方法（支持自适应电脑、手机、iPad等多种设备）

### 1. 登录/注册系统
- 客户首次使用需注册账号，注册时只需填写用户名和密码
- 注册成功后自动获得客户权限，无需选择账户类型
- 已注册客户可直接使用账号（用户名和密码）登录系统
- 登录成功后进入客户主页面
- **密码管理**：
  - 支持修改密码功能，需要验证旧密码
  - 支持找回密码功能，联系管理员获取帮助

### 2. 上传照片
- **文件选择**：点击"选择文件"按钮，可以选择多个文件
- **支持格式**：
  - 图片：JPG、PNG、GIF、WEBP格式
  - 压缩包：ZIP、RAR、7Z格式
- **上传限制**：
  - 一次最多上传20个文件
  - 图片文件总大小不得超过50MB
  - 压缩包文件无大小限制
- **重复检测**：系统会自动检测重复文件，防止重复上传
- **商家选择**：从下拉菜单选择一个商家（必须是系统中存在且未被禁用的商家）
- **备注信息**：可选填写备注信息
- **中文支持**：完全支持中文文件名，无乱码问题

### 3. 管理照片
- **查看列表**：系统显示所有已上传的文件列表，包含图片预览和文件信息
- **图片预览**：
  - 图片文件显示实际图片内容，点击可放大查看
  - 压缩包文件显示压缩包图标
- **编辑备注**：
  - 点击备注文本或编辑按钮可以修改备注
  - 使用自定义编辑框，支持多行文本和字符计数
  - 最多可编辑10次
- **查看状态**：状态栏显示照片的处理状态（已接收、处理中、已发货）
- **删除照片**：
  - 点击操作栏的"删除"按钮可以删除照片
  - 删除的条目显示变灰，状态栏改为"客户已删除"
  - 删除的文件移动到列表最后，操作栏改为"恢复"按钮
  - 点击"恢复"可以恢复删除的文件

### 4. 筛选和分页功能
- **状态筛选**：可以按照处理状态筛选文件（已接收、处理中、已发货）
- **时间筛选**：
  - 预设选项：今天、最近一周、最近一个月
  - 自定义时间范围：可以选择具体的开始和结束日期
- **分页浏览**：
  - 支持每页显示10、20、50、100条记录
  - 智能分页导航，显示当前页和总页数
  - 支持直接跳转到指定页码
  - 操作后保持当前页面，不会跳回第一页
- **文件预览管理**：
  - 支持在文件选择阶段预览已选文件
  - 可以移除单个文件，无需重新选择
  - 优化文件选择界面，避免浏览器默认文本干扰
- **退出登录**：点击右上角的"退出"按钮可以安全退出到登录/注册页面

## 三、商家端使用方法（支持自适应电脑、手机、iPad等多种设备）

### 1. 登录系统
- 商家账号由管理员或子管理员创建，无需自行注册
- 使用管理员分配的商家账号（用户名和密码）登录系统
- 登录成功后进入商家管理页面

### 2. 客户管理
- **客户列表**：显示所有给本商家上传过文件的客户信息
- **客户状态**：
  - 正常客户显示绿色"正常"标签
  - 被禁用客户显示红色"禁用"标签，无法查看其照片
- **客户详情**：点击"查看照片"按钮进入该客户的照片管理页面
- **分页功能**：
  - 支持客户列表的分页浏览
  - 默认每页显示20条记录
  - 支持每页显示10、20、50、100条记录

### 3. 照片管理
- **照片列表**：
  - 显示客户上传的所有文件，包括图片预览和文件信息
  - 图片文件显示实际图片内容，点击可放大查看
  - 压缩包文件显示压缩包图标
  - 客户已删除的文件显示在列表最后，无法进行操作
- **状态管理**：
  - 可以更改照片处理状态：已接收、处理中、已发货
  - 客户已删除的照片不可更改状态
- **筛选功能**：
  - 按状态筛选：已接收、处理中、已发货
  - 按时间筛选：今天、最近一周、最近一个月、自定义时间范围

### 4. 下载功能
- **单张下载**：点击操作栏"下载"按钮下载单张文件
- **批量下载**：
  - 普通批量下载：点击"批量下载"按钮下载客户的所有文件
  - 选择性批量下载：
    - 点击"批量下载"进入选择模式
    - 显示全选、全不选、反选控制按钮
    - 支持跨页选择文件
    - 选择完成后点击"下载(X)"按钮（X为选中数量）
    - 自动打包为ZIP文件下载
    - 下载不会打开新标签页，直接触发文件下载
- **下载限制**：客户已删除的文件不可下载
- **下载状态**：系统自动记录每次下载的状态（成功、失败）

### 5. 下载状态管理
- **状态显示**：每个文件显示下载状态（未下载、已下载、下载失败）
- **重新下载**：对于下载失败的文件，可以重新尝试下载
- **状态持久化**：下载状态与账号关联，重新登录后仍可查看

## 四、系统功能对比

| 功能 | 主管理员 | 子管理员 | 商家端 | 客户端 |
|------|----------|----------|--------|--------|
| 创建用户 | ✓（所有角色） | ✓（商家/客户） | ✗ | ✗ |
| 用户管理 | ✓ | ✓（限制） | ✗ | ✗ |
| 操作日志 | ✓（全部） | ✓（部分） | ✗ | ✗ |
| 上传文件 | ✗ | ✗ | ✗ | ✓ |
| 编辑备注 | ✗ | ✗ | ✗ | ✓（限10次） |
| 删除文件 | ✗ | ✗ | ✗ | ✓ |
| 查看状态 | ✗ | ✗ | ✓ | ✓ |
| 更改状态 | ✗ | ✗ | ✓ | ✗ |
| 下载文件 | ✗ | ✗ | ✓ | ✗ |
| 批量下载 | ✗ | ✗ | ✓ | ✗ |
| 客户管理 | ✗ | ✗ | ✓ | ✗ |
| 筛选功能 | ✗ | ✗ | ✓ | ✓ |

## 五、技术特点

1. **角色权限管理**：基于角色的访问控制，确保不同用户只能访问相应功能
2. **文件安全**：支持中文文件名，自动编码转换，防止乱码问题
3. **状态管理**：照片处理状态和下载状态都与账号关联，保证数据一致性
4. **批量操作**：支持跨页选择和批量下载，提高操作效率
5. **筛选查询**：支持多维度筛选，快速定位目标文件
6. **响应式设计**：完美适配PC、平板、手机等多种设备
7. **用户体验**：
   - 现代化UI设计，自定义模态框，流畅的交互体验
   - 统一的分页系统，三端一致的用户体验
   - 智能搜索和筛选功能，提高操作效率
   - 完善的中文显示，所有界面元素本地化
8. **数据完整性**：完整的操作日志记录，支持审计和追溯
9. **系统稳定性**：完善的错误处理和用户反馈机制

## 六、常见问题解答

### 1. 管理员问题
- **问题**：忘记管理员密码
  **解答**：默认管理员账户为 admin/xxxx，如已修改请联系系统维护人员

- **问题**：无法创建子管理员
  **解答**：只有主管理员才能创建子管理员，子管理员无此权限

- **问题**：看不到某些用户的操作日志
  **解答**：子管理员无法查看主管理员和其他子管理员的操作记录

- **问题**：创建用户后没有提示
  **解答**：系统已优化，创建用户成功后会显示绿色成功提示

- **问题**：操作记录显示英文
  **解答**：系统已全面中文化，所有操作类型和详情都显示为中文

- **问题**：用户忘记密码怎么办
  **解答**：管理员可以在用户管理页面点击"重置密码"按钮，为用户设置新密码

### 2. 客户端问题
- **问题**：上传文件失败
  **解答**：请检查网络连接，确保选择了商家，文件格式正确，大小不超过限制

- **问题**：中文文件名显示乱码
  **解答**：系统已修复此问题，支持完整的中文文件名显示

- **问题**：无法编辑备注
  **解答**：每个文件的备注最多只能编辑10次，超过次数后将无法修改

- **问题**：提示"请勿重复上传"
  **解答**：系统检测到相同文件名的文件已上传给同一商家，请检查是否重复

- **问题**：如何修改密码
  **解答**：在登录页面点击"修改密码"链接，输入用户名、旧密码和新密码即可

- **问题**：忘记密码怎么办
  **解答**：在登录页面点击"找回密码"链接，联系管理员获取帮助

### 3. 商家端问题
- **问题**：下载文件失败
  **解答**：可能是网络问题或服务器繁忙，稍后重试或联系管理员

- **问题**：找不到某个客户的照片
  **解答**：确认该客户是否已上传文件，或检查客户是否被管理员禁用

- **问题**：批量下载没有反应
  **解答**：请确保至少选择了一个文件，大文件下载需要等待时间

- **问题**：无法查看被禁用客户的照片
  **解答**：这是系统安全设计，被禁用的客户照片无法查看，请联系管理员

- **问题**：批量下载打开新标签页
  **解答**：系统已优化，批量下载会直接触发文件下载，不会打开新标签页

### 4. 系统问题
- **问题**：页面显示异常或按钮无反应
  **解答**：尝试刷新页面（F5），清除浏览器缓存，或使用其他浏览器

- **问题**：上传或下载速度很慢
  **解答**：检查网络连接，大文件传输需要更多时间，请耐心等待

## 七、启动说明

### 快速启动
1. **Windows用户**：双击 `start.bat` 文件
2. **PowerShell用户**：运行 `start.ps1` 文件
3. **手动启动**：在项目目录运行 `npm start`

### 启动后
- 服务器将在端口3000启动
- 浏览器会自动打开 http://localhost:3000
- 控制台窗口会保持打开状态，显示运行日志

### 故障排除
- 如果端口被占用，会自动终止冲突进程
- 如果启动失败，检查Node.js是否正确安装
- 确保项目目录下有 `node_modules` 文件夹

## 八、联系方式

如有任何使用问题或建议，请联系系统管理员：

- 电话：135-9339-3484
- 邮箱：1915316345@qq.com
- 工作时间：周一至周五 9:00-18:00

---
*系统版本：v1.0*  
*文档版本：v3.0*
*更新日期：2025年10月3日*  